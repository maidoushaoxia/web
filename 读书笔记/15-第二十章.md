# 《JavaScript高级程序设计》读书笔记 #


## 第二十章 JSON ##

---------------------
### 20.1 语法 ###
- 简单值:与JavaScript相同的语法,但不支持undefined.

- 复杂值:对象是一种复杂数据类型,表示一组无序的键值对.

- 数组:数组也是一种复杂数据类型,表示一组有序的值的列表.
----------
1. 简单值
  - JSON字符串必须使用双引号,其余无区别.

2. 对象
  - JSON中对象不需要声明变量;
  - 对象的属性必须加双引号;
  - 末尾不需要分号.

3. 数组
  - 同样不需要声明变量;
  - 末尾没有分号.

### 20.2 解析与序列化 ###
1. JSON对象
  - JSON对象是JavaScript语法的子集,因此可以用eval()函数解析,解释并返回JavaScript对象和数组.

  - stringify():用于将JavaScript对象序列化为JSON字符串.接收JavaScript对象参数.此方法输出的JSON字符串不包含任何空格字符或缩进.

  - parse():将JSON字符串解析为原生JavaScript值.接收JSON字符串参数.

2. 序列化选项:stringify()方法还可以接收两个参数,用于指定以不同的方式序列化JavaScript对象.第一个参数是个过滤器,可以是个数组,也可以是一个函数;第二个参数是一个选项,表示是否保留空格和缩进.

  - 过滤结果:
    - 如果过滤器参数是数组,那结果中将只包含数组中列出的属性.

    - 如果过滤器参数是函数,函数接收属性名(key)和属性值(value),属性名必须是字符串,属性值可以是空字符串.可以通过函数改变对象序列化的结果,函数返回值就是相应键的值,如果返回undefined,则该属性会被忽略(即删除,不被序列化).default项会显示传入的值.
  
  - 字符串缩进
    - 第三个参数如果是一个数值,则代表每个级别要缩进的空格数.如果传入了有效的控制缩进的参数值(最小为1,最大为10.大于10会自动转换为10),则结果字符串就会包含换行符.

    - 如果缩进参数是一个字符串,则这个字符串被用作缩进字符(如制表符,两个短划线等).

  - toJSON()方法
    - 返回其自身的JSON数据格式.

    - 该方法可以作为函数过滤器的补充.将对象传入JSON.stringify(),序列化对象的顺序如下:
      - 如果存在toJSON()方法,且能通过它取得有效的值,则调用该方法.否则返回对象本身.
      - 如提供了第二个参数,则将上面返回的值传入函数过滤器.
      - 对上一步返回的每个值进行序列化.
      - 如果提供第三个参数,则执行相应的序列化.

3. 解析选项:parse()方法也可以接收一个参数,该参数是一个函数(还原函数),将在每个键值对上调用.该函数接收的参数与过滤函数一样,且都返回一个值.可以返回创建的新对象,这样就能调用方法了.(见书p569例子)

