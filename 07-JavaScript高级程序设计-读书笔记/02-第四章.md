<!--
 * @Author: shaoyun
 * @Date: 2019-04-20 21:29:18
 * @LastEditors: shaoyun
 * @LastEditTime: 2019-09-02 20:43:07
 * @Description: 
 -->
# 《JavaScript高级程序设计》读书笔记 #

## 第四章  变量、作用域和内存问题 ##
----------

### 4.1 基本类型和引用类型的值 ###
- 5种基本类型可以直接操作保存在变量中的实际的值,因此**是按值访问的**.
- 引用类型的值是保存在内存中的各对象,在操作对象时,实际上是操作对象的引用而不是实际的对象.因此,引用类型的值是**按引用访问的**.

----------

1. 动态的属性
	**只能给引用类型的值添加属性和方法**

2. 复制变量值
	- 复制基本类型的值,两个变量不会有影响.
	- 复制引用类型的值,**两个保存在变量对象中的变量引用的都是同一个对象(即保存在堆内存中的对象)**.因此,改变其中一个变量,就会影响另一个变量.

3. 传参(**重要,p71**)
	- 所有函数的参数只能按值传递.
	- 传递基本类型的值时,被传递的值会复制给一个局部变量(即arguments的一个元素).
	- 传递引用类型的值时,会把这个值在内存中的地址复制给一个局部变量.
	- **即使在函数内部修改了参数的值,原始的引用仍然保持不变**.实际上,在函数内部修改参数,这个变量引用的就是一个局部对象,此局部对象在函数执行完毕后立即被销毁.

4. 检测类型
	- 检测基本类型用`typeof`.
	- 检测某个值是什么类型(`Object,Array,RegExp`等)的对象,用**instanceof**.
	- **所有引用类型的值都是Object的实例**,因此`instanceof Object`都会返回true;如果检测基本类型,则返回false.

###4.2 执行环境及作用域 ###
- **全局执行环境**是window对象,因此所以全局变量和函数都是作为window对象的属性和方法创建的.
- 代码在一个环境中执行时,会创建变量对象的一个**作用域链**,作用域链的前端始终是当前执行代码所在环境的变量对象.如果这个环境是函数,则将其活动对象作为变量对象.活动对象在最开始时只包含一个变量,即arguments对象,下一个变量来自外部环境...最后一个对象是全局执行环境的变量对象.
- 内部环境可以通过作用域链访问所有的外部环境,但外部环境不能访问内部环境中的任何变量和函数.

----------
1. 延长作用域链
	- try-catch语句的catch块:会创建一个新的变量对象,其中包含的是被抛出的错误对象的声明.
	- with语句:将指定的对象添加到作用域链中.with语句中的变量可以成为函数执行环境的一部分.
	
2. ECMAScript没有块级作用域
	- if语句中的变量声明会将变量添加到当前的执行环境中.
	- for语句创建的变量即使在for循环执行结束后,也依旧会存在循环外部的执行环境中.
	- 如果初始化变量时没有使用var声明,该变量会自动被添加到全局环境.
	- 查询标识符时,从作用域前端开始搜索,如果在局部环境中没有找到变量名,则继续沿作用域向上搜索.如果局部环境存在同名标识符,则不使用父环境中的标识符.

### 4.3 垃圾回收 ###
1. 离开作用域的值将被自动标记为可以回收,常用的垃圾收集算法是"**标记清除**":给不使用的值打上标记.然后再回收其内存.

2. **引用计数"算法**:跟踪记录所以值被引用的次数.在代码中存在循环引用时,会产生问题.

3. **解除变量的引用:**将不需要的数据设置为null来释放其引用.
