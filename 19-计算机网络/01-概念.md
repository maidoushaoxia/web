## 01-概念

### 1.1 Internet的概念

1. 分组交换机：接收其输入通信链路上的包，将其转发到输出通信链路上，作用就是将数据包转发至其在目地。
   - 路由器和链路层交换机都是分组交换机
2. 路由：从发送端到接收端的数据包所遍历的通信链路和数据包交换的顺序称为通过网络的路由或路径。
3. 协议：控制互联网内的收发信息，定义了两个或多个通信实体之间交换的消息的格式和顺序，以及对消息的发送或接收所采取的操作。
4. 分布式应用：设计相互交换数据的多个终端系统
5. 套接字接口：规定了一个终端系统上的程序如何要求互联网将数据传递到另一个终端系统上的目标程序，发送端必须遵循的规则，这样才能让互联网将数据传给接收端。

### 1.2 网络边缘

1. 终端：也就是主机，分为客户端和服务器两种。
2. 接入网：是将终端连接到两个终端之间的路径上的第一个路由器（即边缘路由器）的网络。
3. DSL（Digital Subscriber Line）：住宅接入网从本地电话公司获得DSL网络接入，每个客户的DSL调制解调器都使用已有的电话线（双绞线）与位于电信公司本地中央办公室（Center Office）的数字用户线路访问多路复用器（DSLAM）交换数据：
   - 家庭的DSL调制解调器可以获取数字信号并将其转换为模拟信号，从而通过电话线传输到CO；
   - 来自这些住宅的模拟信号在DSLAM处被转换回数字信号。
   - 通过频分复用，住宅电话线能同时传输数据和传统的电话信号：
     - 客户侧，将数据信号与电话信号分开，并将数据信号传进DSL调制解调器；
     - CO侧，将数据信号与电话信号分开，并将数据信号传至互联网。
   - DSL适用于家庭与CP之间距离短的情况。
4. 光缆接入网：利用有线电视接入，光纤将电缆的头端（与因特网相连）与附近的节点（支持500~500间房屋）相连，然后使用传统的同轴电缆将节点与房屋相连。
5. 光纤到家（FTTH）：用光纤将CO与住宅直接相连。
6. 无源光网络（Passive Optical Network）：
   - 每个住宅都有一个光网络终端（ONT），该终端通过专用光纤与相邻的分离器相连；
   - 分离器将许多住宅结合到一条共享的光纤上，这条光纤与CO的光线路终端器（OLT）相连；
   - OLT是提供光电转换的，通过电信路由器与互联网相连；
   - 在住宅中，用户使用家庭路由器连接到ONT，并通过这个路由器访问网络
7. 企业接入网：一般采用以太网，使用双绞线连接到以太网交换机，以太网交换机进而连接到更大的网络。
8. 无线局域网：基于IEEE802.11，如WiFi等，用户需在接入点的十几米以内。
9. 物理媒介，分为引导媒介和非引导媒介
   - 引导媒介：波沿着实体媒介传播，如双绞线、同轴电缆等。
   - 非引导媒介：波在大气层及外部空间传播，如无线局域网等

### 1.3 网络核心

1. 网络核心：连接互联网终端的分组交换机和网络
2. 分组交换：将长消息分成较小的数据包，数据包通过通信链路和分组交换机传输
3. 分组交换机：路由交换机和链路层交换机都属于分组交换机
4. 存储转发传输：分组交换机必须先接收整个数据包，然后才开始将数据包的第一位传输到输出链路上
5. 若一条路径上有N条链路，每条链路的传输速率为R，每个数据包的大小为L，则端到端延迟 = NL / R。
6. 排队延迟：每个链路都有一个输出缓冲区，存储的是路由器即将发送到该链路的数据包。如果到达的数据包需要传输到链路中，但该链路正进行另一个数据包的传输，则到达的数据包必须在输出缓冲区中等待。
7. 丢包：若缓冲区满了，则即将到达的数据包或已经排队的数据包之一将被丢弃。
8. 路由器：使用包的目的地址来索引转发表并决定合适的相邻链路。
9. 路由协议：用来自动配置路由表

10. 电路交换（比如电话）：在终端之间的通信会话持续时间内，保留了用于在终端系统之间进行通信的路径（缓冲区，链路传输速率）所需的资源。

    - 每个链路有 N 条电路，当两个主机要进行通信时，网络将在两个主机之间建立专用的端到端连接；

    - 因此，需要预先保留链接中的一条电路，同时该电路将获得总传输容量的 1 / N；

      

    而对于分组交换，数据包被发送到网络中，不会预先保留链接，如果其中一条链路需要同时传输其他数据包导致拥塞，则该数据包需要在发送端的缓冲区等到，并延迟。

11. 多路复用

    - 频分复用：频域上被划分为多个频带，用户在同一时间占用不同的带宽
    - 时分复用：时域上被划分为多个帧，每一帧都拥有多个时隙，用户在不同时隙占用相同的频带宽度

12. 分组交换与电路交换的主要区别：

    - 电话交换预先分配了传输链路，即使没有用户使用；
    - 分组交换是按需分配的，只有需要传输数据包的才可以使用链路

### 1.4 分组交换网络中的时延、丢包和吞吐量

1. 时延的类型
   - **节点处理时延**：节点检查数据包的头部，确定包的下一站链路，并将包转发至该链路，这个过程所需的时间
   - **排队时延**：等待发送到链路的时间，取决于之前到达的队列中的数据包
   - **传输时延**：将数据包的所有比特数传输至链路中所需要的时间，若数据包大小为 L 比特，链路的传输速率为 R bit /s，则传输时延为 L / R
   - **传播时延**：从链路的🕖传播至另一个节点所需的时间，取决于链路的物理媒介
   - 【**注意**】：传输时延是数据包大小与链路传输速率的函数，与两个节点（路由）之间的距离无关，而传播时延是将 1 比特从一个路由传播至另一个路由所需的时间，是两个路由之间距离的函数，与数据包的大小及链路的传输速率无关。
2. 排队时延
   - 每个包的队列时延都不尽相同
   - 排队时延的大小取决取决于流量到达队列的速率，链路的传输速率以及到达的流量的性质（周期性到达或突发到达）
   - 假设包到达队列的平均速率是 a packet/s，所以包的大小都是 L 比特， 则比特到达队列的平均速率为 La bits/s，比率 La / R被称为**流量强度**
   - 若 La / R > 1，比特到达队列的平均速率超过了从队列传输比特的速率，这时队列延时接近无穷大
   - 若包是周期性到达，则不会有队列时延，而数据包突发到达时，就会有队列时延
3. 丢包
   - 队列的容量是有限的，当流量强度接近1时，数据包时延不会接近无限，由于队列满了，路由器就会将那个包丢弃
   - 从终端的视角看，丢包是指包以及传输到网络中，但是未能到达目的地
   - 丢包的比例随着流量强度的增加而增加

4. 端到端时延
   - 若两端之间有 N - 1个路由器，忽略排队时延，则端到端的时延为 N(dproc + dtrans + dprop)
5. 吞吐量
   - 只有一个路由器时，若服务端到路由器的链路传输速率为 Rs，路由器到客户端的链路传输速率为Rc，则吞吐量为min{Rc, Rs}
   - 同理，有N - 1个路由器（N条链路时），吞吐量为min{R1, R2, ... RN}
   - 若10个服务器与10个客户端之间都会经过一个链路，假设该链路的传输速率为R。
     - 若R非常大（是Rc与Rs的几千倍），则网络的吞吐量仍为min{Rc, Rs}
     - 若R与Rc和Rs是一个数量级的，则网络吞吐量为R / 10

### 1.5 协议层与服务模型

1. 协议分层：每一层通过在该层执行某些动作来提供其服务，同时使用其下一层的服务
2. 协议栈：不同层的协议
   - 因特网协议栈（五层模型）：
     - 应用层
     - 传输层
     - 网络层
     - 链路层
     - 物理层
   - OSI七层模型：
     - 应用层
     - 表示层
     - 会话层
     - 传输层
     - 网络层
     - 链路层
     - 物理层
3. 应用层：应用层中的信息包称为**消息**
   - HTTP协议：提供Web服务
   - SMTP：传输邮件
   - FTP：传输文件
4. 传输层：在应用之间传输应用层的消息，传输层的包称为**片段**
   - TCP：为其他应用程序提供面向连接的服务
     - 确保将应用层消息传递给目标，并进行流控制（发送端与接收端的速度匹配）
     - 将长消息分段，提供拥塞控制机制，当网络拥塞时，源会限制传输速率
   - UDP：面向无连接的服务
5. 网络层：网络层的中包称为**数据报**
   - 传输层协议将片段与目标地址传给网络层，然后网络层将片段发送给目标主机的传输层
   - IP协议：定义了数据报中的字段以及终端系统和路由器在这些字段上的行为
   - 路由协议：确定数据报在源和目的地址之间采用的路由
6. 链路层：链路层中的包称为**帧**
   - 网络层将数据报向下传给链路层，链路层沿着路由传给下一节点的链路层，再传递给网络层
   - 常见链路层协议：WIFI、以太网等
7. 物理层：将帧中的各个比特从一个节点传至另一个节点
   - 物理层协议取决于链路以及链路的实际传输介质
8. 表示层：允许通信的应用程序解释所交换数据的含义
   - 包括数据压缩、数据加密以及数据描述
9. 会话层：两个节点间建立、维护和释放面向用户的连接，并对会话进行管理和控制，保证会话数据可靠传送。
10. 封装：每一层的包由两部分组成，头部信息和从上一层传来的包
