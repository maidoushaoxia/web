## HTTP首部

### 6.1 报文首部

- 请求报文

- 响应报文

### 6.2 首部字段

- 通用首部字段：请求报文和响应报文都会使用的
- 请求首部字段
- 响应首部字段
- 实体首部字段

### 6.3 通用首部字段

#### 1. Cache-Control：操作缓存的工作机制

- public/private：决定所所有用户还是特定用户可以使用缓存
- no-cache：防止从缓存中返回过期的资源，缓存回向源服务器进行有效期确认后处理资源
  - 客户端请求中有此指令，则表示客户端不接收缓存过的响应
  - 服务器响应中有此指令，表示缓存服务器不能对资源进行缓存
- no-store：不进行缓存
- s-maxage：适用于代理服务器，使用此指令，会忽略对Expires首部字段及max-age指令的处理
- max-age：
  - 客户端请求中有此指令时，如果缓存资源的缓存时间数值比指定时间的数值小，则客户端接收缓存资源。若max-age值为0，则缓存服务器会将请求转发给源服务器。
  - 服务器响应中有此指令时，缓存服务器将不对资源的有效性再做确认，max-age的值表示资源保存为缓存的最长时间。
- min-fresh：要求缓存服务器返回还未过指定时间的缓存资源。
- max-stale：未指定参数值时，无论经过多久，客户端都会接收响应；如果指令中指定了具体数值，则即使缓存过期，也会被客户端接收。
- only-if-cached：缓存服务器不重新加载响应，也不会再次确认资源有效性
- must-revalidate：代理会向源服务器再次验证即将返回的响应缓存目前是否有效
- proxy-revalidate：缓存服务器返回响应之前，必须再次验证缓存的有效性
- no-transform：规定缓存不能改变实体主体的媒体类型，防止缓存或代理压缩图片等

#### 2. Connection

- 代理服务器将Connection字段删除后再转发
- 管理持久连接，值为close/keep-alive

#### 3. Date

- 创建HTTP报文的时间

#### 4. Pragma

- 用来作为HTTP/1.0的向后兼容

#### 5.Trailer

- 事先说明在报文主体后记录了哪些首部字段

#### 6. Transfer-Encoding

- 规定了传输报文主体时采用的编码 方式

#### 7. Upgrate

- 用于检测 HTTP 协议及其他协议是否可使用更高的版本进行通信

#### 8. Via

- 追踪客户端与服务器之间的请求和响应报文的传输路径

#### 9. Warning

- 告知用户一些与缓存相关的问题的警告，格式如下

  `Warning: [警告码][警告的主机:端口号]“[警告内容]”([日期时间])`

### 6.4 请求首部字段

#### 1. Accept

- 可通知服务器，客户端能够处理的媒体类型及相对优先级，可以用`type/subtype`一次指定多种媒体类型，也可指定权重，如：

  `Accept: text/html;q=0.3,application/xml`

#### 2. Accept-Charset

- 用来通知服务器客户端支持的字符集及相对优先级

#### 3. Accept-Encoding

- 告知服务器客户端支持的内容编码及相对优先级

#### 4. Accept-Language

- 告知服务器客户端能够处理的自然语言集及相对优先级

#### 5. Authorization

- 告知服务器，客户端的认证信息

#### 6. Except

- 客户端告知服务器，期望出现的魔杖特定行为，如服务器无法理解，会返回417状态码

#### 7. Form

- 告知服务器用户的电子邮件地址

#### 8. Host

- 告知服务器，请求的资源所处的互联网主机名和端口号。因为虚拟主机运行在同一个IP上

#### 9. If-Match

- If-xxx是条件请求，只有判断指定条件为真时，才会执行请求
- If-Match的字段值跟ETag值一致时，服务器才会接受请求

#### 10. If-Modified-Since

- 在 If-Modified-Since 字段指定的日期时间后，资源发生了更新，服务器才会接受请求，否则返回304状态码

#### 11. If-None-Match

- 与If-Match作用相反

#### 12. If-Range

- If-Range 字段值若是跟 ETag 值或更新的日期时间匹配一致，

  那么就作为范围请求处理，否则忽略范围请求，返回全部资源。

#### 13. If-Unmodified-Since

- 与If-Modified-Since作用相反

#### 14. Max-Forwards

- 当Max-Forwards字段值为0时，服务器会立即返回响应。

#### 15. Proxy-Authorization

- 客户端与代理服务器之间的认证

#### 16.Range

- 返回部分资源

#### 17. Referer

- 告知服务器请求的原始资源的URI

#### 18. TE

- 告知服务器客户端能够处理响应的传输编码方式及相对优先级

#### 19. User-Agent

- 创建请求的浏览器和用户代理名称等信息传达给服务器

### 6.5 响应首部字段

#### 1. Accept-Ranges

- 用来告知客户端服务器是否能够处理范围请求，可以的话值为bytes，否则为none

#### 2. Age

- 告知客户端，源服务器在多久前创建了响应

#### 3. ETag

- 将资源以字符串形式做唯一性标识，当资源更新时，Etag值也更新。
  - 强Etag：只要变化就改变值
  - 弱Etag：在字段最开始处附加W，只用于提示资源是否相同，只有发生根本性变化才更新

#### 4. Location

- 配合重定向的响应，提供重定向的URI

#### 5. Proxy-Authenticate

- 把代理服务器要求的认证信息发送给客户端

#### 6. Retry-After

- 告知客户端应该在多久之后再次发送请求

#### 7. Server

- 告知客户端当前服务器上安装的 HTTP 服务器的信息

#### 8. Vary

- 可对缓存进行控制。代理服务器接收到带有Vary的响应后，若再要进行缓存，仅对请求中含有相同Vary指定首部字段的请求返回缓存。

#### 9. WWW-Authenticate

- 用于HTTP访问认证，401响应中肯定有此字段。

#### 6.6 实体首部字段

#### 1. Allow

- 用于通知客户端，服务器所支持的 HTTP 方法，若接收到不支持的HTTP方法，会返回405 Method Not Allowed。

#### 2. Content-Encoding

- 告知客户端服务器对实体的主体部分的内容编码方式

#### 3. Content-Language

- 告知客户端，实体主体使用的语言

#### 4. Content-Length

- 表明实体主体部分的大小

#### 5. Content-Location

- 给出与报文主体部分相对应的 URI

#### 6. Content-MD5

- 是一串由 MD5 算法生成的值，用来检查报文主体在传输过程中是否保持完整，以及确认传输到达

#### 7. Content-Range

- 告知客户端作为响应返回的实体的哪个部分符合范围请求

#### 8. Content-Type

- 说明实体主体内对象的媒体类型

#### 9. Expires

- 将资源失效的日期告知客户端
- 相比于Expires，max-age优先级更高

#### 10. Last-Modified

- 指明资源最终修改的时间